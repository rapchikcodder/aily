import{a as l}from"./utils-P31o8Rby.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();const f=o=>{let t;const e=new Set,r=(i,d)=>{const n=typeof i=="function"?i(t):i;if(!Object.is(n,t)){const y=t;t=d??(typeof n!="object"||n===null)?n:Object.assign({},t,n),e.forEach(b=>b(t,y))}},s=()=>t,u={setState:r,getState:s,getInitialState:()=>m,subscribe:i=>(e.add(i),()=>e.delete(i))},m=t=o(r,s,u);return u},I=(o=>o?f(o):f),v=o=>o;function g(o,t=v){const e=l.useSyncExternalStore(o.subscribe,l.useCallback(()=>t(o.getState()),[o,t]),l.useCallback(()=>t(o.getInitialState()),[o,t]));return l.useDebugValue(e),e}const p=o=>{const t=I(o),e=r=>g(t,r);return Object.assign(e,t),e},S=(o=>o?p(o):p),h=S((o,t)=>({currentTopic:"",questions:[],answers:[],currentQuestionIndex:0,aiProvider:"local",isLocalAIAvailable:!1,localAIStatus:"unknown",apiKeys:{},customVariables:[],promptHistory:[],setTopic:e=>o({currentTopic:e}),setQuestions:e=>o({questions:e,currentQuestionIndex:0}),answerQuestion:e=>{const{answers:r}=t(),s=r.findIndex(a=>a.questionId===e.questionId);if(s>=0){const a=[...r];a[s]=e,o({answers:a})}else o({answers:[...r,e]})},nextQuestion:()=>{const{currentQuestionIndex:e,questions:r}=t();e<r.length-1&&o({currentQuestionIndex:e+1})},previousQuestion:()=>{const{currentQuestionIndex:e}=t();e>0&&o({currentQuestionIndex:e-1})},resetInterview:()=>o({currentTopic:"",questions:[],answers:[],currentQuestionIndex:0}),checkLocalAI:async()=>{try{const e=window;if(!("ai"in e)||!("languageModel"in e.ai)){o({isLocalAIAvailable:!1,localAIStatus:"unavailable"});return}const r=await e.ai.languageModel.capabilities();r.available==="readily"?o({isLocalAIAvailable:!0,localAIStatus:"ready",aiProvider:"local"}):r.available==="after-download"?o({isLocalAIAvailable:!1,localAIStatus:"downloading"}):o({isLocalAIAvailable:!1,localAIStatus:"unavailable"})}catch(e){console.error("Error checking local AI:",e),o({isLocalAIAvailable:!1,localAIStatus:"unavailable"})}},setAIProvider:e=>o({aiProvider:e}),setAPIKey:(e,r)=>{const{apiKeys:s}=t();o({apiKeys:{...s,[e]:r}}),t().saveToStorage()},addCustomVariable:e=>{const{customVariables:r}=t();o({customVariables:[...r,e]}),t().saveToStorage()},removeCustomVariable:e=>{const{customVariables:r}=t();o({customVariables:r.filter(s=>s.trigger!==e)}),t().saveToStorage()},saveToHistory:e=>{const{promptHistory:r}=t(),s=[e,...r].slice(0,100);o({promptHistory:s}),t().saveToStorage()},clearHistory:()=>{o({promptHistory:[]}),t().saveToStorage()},loadFromStorage:async()=>{if(typeof chrome<"u"&&chrome.storage&&chrome.storage.local)try{const r=await chrome.storage.local.get(["apiKeys","customVariables","promptHistory","aiProvider"]);o({apiKeys:r.apiKeys||{},customVariables:r.customVariables||[],promptHistory:r.promptHistory||[],aiProvider:r.aiProvider||"local"})}catch(e){console.error("Error loading from storage:",e)}},saveToStorage:async()=>{if(typeof chrome<"u"&&chrome.storage&&chrome.storage.local)try{const{apiKeys:e,customVariables:r,promptHistory:s,aiProvider:a}=t();await chrome.storage.local.set({apiKeys:e,customVariables:r,promptHistory:s,aiProvider:a})}catch(e){console.error("Error saving to storage:",e)}}}));export{h as u};
